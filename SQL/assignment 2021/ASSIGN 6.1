--A-1 :DEPARTMENT WISE TEAM SIZE AND AVERAGE SALARY OF ALL EMPLOYEES. 
--A-2 : COUNT OF MANAGERS IN THE COMPANY.--
--A-3 : MAXIMUM & MINIMUM SALARY OF AN ASSOCIATE.
--A-4 : DEPARTMENT WISE TEAM SIZE AND AVERAGE SALARY OF DELHI EMPLOYEES. 
--A-5 : GENERATE OFFICIAL EMAIL OF THE EMPLOYEE TAKING 1ST CHARATCET OF FIRST NAME , 1ST CHARATCER OF LAST NAME , LAST 3 DIGITS OF EID, FOLLED BY ‘RCG.COM’. EMAIL SHOULD BE IN A UPPER CASE. 
--A-6 : NAME,CITY , PHNO & EMAIL OF THE EMPLOYEES WHOSE AGE >=40.
--A-7 : EID, NAME DOJ OF EMPLOYEES WHO HAVE COMPLETED 5 YEARS IN THE COMPANY 
--A-8 : DETAILS OF THE MANAGERS HAVING BIRTHDAY IN THE CURRENT MONTH
--A-9 : EID, DEPT , DESI , SALARY OF THE EMPLOYEE WHO IS GETTING THE MAXIMUM SALARY
--A-10 : EID, NAME OF EMPLOYEE WHO HAS LONGEST NAME


USE TEST;

SELECT * FROM emp_sal;
SELECT * FROM emp_info;

--A-1 :DEPARTMENT WISE TEAM SIZE AND AVERAGE SALARY OF ALL EMPLOYEES. ---

SELECT DEPT,COUNT(DEPT) AS NO_OF_EMP,AVG(BASIC) AS AVG_SALARY FROM EMP_SAL
GROUP BY DEPT;

--A-2 : COUNT OF MANAGERS IN THE COMPANY.--

SELECT DEPT,COUNT(DEPT) AS NO_OF_MANAGERS FROM emp_sal
WHERE DESIG = 'MGR'
GROUP BY DEPT;

--A-3 : MAXIMUM & MINIMUM SALARY OF AN ASSOCIATE.--

SELECT MIN(BASIC) AS MIN_SAL,MAX(BASIC) MAX_SAL FROM emp_sal
WHERE DESIG = 'ASSO'

--A-4 : DEPARTMENT WISE TEAM SIZE AND AVERAGE SALARY OF DELHI EMPLOYEES. 

SELECT DEPT,COUNT(DEPT) AS DEPT_SIZE, AVG(BASIC) AS AVG_SALARY
FROM emp_info
INNER JOIN emp_sal
ON emp_info.EMP_ID =emp_sal.EMP_ID
WHERE CITY = 'DELHI'
GROUP BY DEPT;

--A-5 : GENERATE OFFICIAL EMAIL OF THE EMPLOYEE TAKING 1ST CHARATCET OF FIRST NAME , 1ST CHARATCER OF LAST NAME , LAST 3 DIGITS OF EID, FOLLED BY ‘RCG.COM’. EMAIL SHOULD BE IN A UPPER CASE. 


SELECT * FROM emp_info;

SELECT LEFT(NAME,1) AS 1ST_NAME_CHAR AS  FROM EMP_INFO;

SELECT CHARINDEX(' ',NAME) FROM emp_info;

SELECT SUBSTRING(NAME,(CHARINDEX(' ',NAME)+1),1) FROM  emp_info;

SELECT LEFT(NAME,1) AS FIRST_NAME_CHAR,SUBSTRING(NAME,CHARINDEX(' ',NAME),2) AS LAST_NAME_CHAR, RIGHT(EMP_ID,3)  FROM EMP_INFO;

SELECT EMP_ID,NAME, CONCAT(LEFT(NAME,1), SUBSTRING(NAME,(CHARINDEX(' ',NAME)+1),1), RIGHT(EMP_ID,3),'@RGC.COM') AS CORP_MAIL FROM emp_info;



SELECT EMP_ID,NAME,UPPER( CONCAT(LEFT(NAME,1), SUBSTRING(NAME,(CHARINDEX(' ',NAME)+1),1), RIGHT(EMP_ID,3),'@RGC.COM')) AS CORP_MAIL FROM emp_info;
